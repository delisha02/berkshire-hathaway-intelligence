# Berkshire Hathaway Intelligence

An AI-powered RAG (Retrieval-Augmented Generation) application that intelligently answers questions about Warren Buffett's investment philosophy using Berkshire Hathaway shareholder letters from 1977-2024.

## ğŸš€ Features

- **RAG Pipeline**: Semantic search across 6 years of shareholder letters (2019-2024)
- **Streaming Responses**: Real-time AI responses with character-by-character streaming
- **Source Attribution**: Automatic citation of letter years used in responses
- **Conversation Memory**: Persistent chat history with context preservation
- **AI-Generated Titles**: Smart conversation titles generated by AI
- **Modern UI**: Gemini-inspired interface with left sidebar, temporal grouping, and search

## ğŸ—ï¸ System Architecture

```mermaid
flowchart TB
    subgraph Frontend["ğŸ–¥ï¸ Frontend (Next.js)"]
        UI[Chat Interface]
        Stream[Streaming Handler]
        Memory[Conversation Display]
    end

    subgraph Mastra["âš¡ Mastra Backend"]
        Agent[Berkshire Agent<br/>GPT-4o]
        RAG[RAG Tool]
        MemoryStore[Memory System]
    end

    subgraph Storage["ğŸ’¾ Storage Layer"]
        PG[(PostgreSQL<br/>pgvector)]
        LibSQL[(LibSQL<br/>Conversations)]
    end

    subgraph Data["ğŸ“„ Data Pipeline"]
        PDF[Shareholder Letters<br/>1977-2024]
        Embed[OpenAI Embeddings]
    end

    UI --> |User Query| Agent
    Agent --> |Semantic Search| RAG
    RAG --> |Vector Query| PG
    PG --> |Relevant Chunks| RAG
    RAG --> |Context| Agent
    Agent --> |Streaming Response| Stream
    Stream --> |Display| Memory
    Agent --> |Save Thread| MemoryStore
    MemoryStore --> LibSQL

    PDF --> |Ingest & Chunk| Embed
    Embed --> |Store Vectors| PG
```

### Data Flow

1. **User Query** â†’ Sent to Mastra Agent via streaming API
2. **RAG Retrieval** â†’ Agent uses RAG tool to search vector database
3. **Context Assembly** â†’ Relevant document chunks retrieved with metadata
4. **AI Generation** â†’ GPT-4o generates response with citations
5. **Streaming Response** â†’ Real-time character-by-character display
6. **Memory Persistence** â†’ Conversation saved for continuity

## ğŸ“‹ Prerequisites

- Node.js 18+
- OpenAI API Key
- npm or yarn

## ğŸ› ï¸ Installation

1. **Clone the repository**
   ```bash
   git clone https://github.com/delisha02/berkshire-hathaway-intelligence.git
   cd berkshire-hathaway-intelligence
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Configure environment**
   ```bash
   # Create .env file
   cp .env.example .env
   
   # Add your OpenAI API key
   OPENAI_API_KEY=your-api-key-here
   ```

4. **Ingest shareholder letters**
   ```bash
   npx tsx src/scripts/ingest-documents.ts
   ```

## ğŸš€ Running the Application

Start both the Mastra backend and Next.js frontend:

```bash
npm run dev:all
```

Access the application:
- **Frontend**: [http://localhost:3000](http://localhost:3000)
- **Mastra Studio**: [http://localhost:4111](http://localhost:4111)
- **API**: [http://localhost:4111/api](http://localhost:4111/api)

## ğŸ“ Project Structure

```
berkshire-hathaway-intelligence/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                    # Next.js frontend
â”‚   â”‚   â”œâ”€â”€ page.tsx            # Main chat interface
â”‚   â”‚   â”œâ”€â”€ layout.tsx          # App layout
â”‚   â”‚   â””â”€â”€ globals.css         # Global styles
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â””â”€â”€ MastraProvider.tsx  # Mastra client provider
â”‚   â”œâ”€â”€ mastra/
â”‚   â”‚   â”œâ”€â”€ agents/             # AI agents
â”‚   â”‚   â”œâ”€â”€ tools/              # RAG retrieval tool
â”‚   â”‚   â”œâ”€â”€ index.ts            # Mastra configuration
â”‚   â”‚   â”œâ”€â”€ storage.ts          # Persistent storage
â”‚   â”‚   â””â”€â”€ vector-store.ts     # Vector database
â”‚   â””â”€â”€ scripts/
â”‚       â””â”€â”€ ingest-documents.ts # Document ingestion script
â”œâ”€â”€ Berkshire_Hathaway_Shareholder_Letters/  # Source documents
â””â”€â”€ TESTING_DEPLOYMENT.md       # Testing & deployment guide
```

## ğŸ§ª Testing

See [TESTING_DEPLOYMENT.md](./TESTING_DEPLOYMENT.md) for comprehensive testing instructions.

### Quick Test Queries:

1. "What is Warren Buffett's investment philosophy?"
2. "What companies did Berkshire acquire in 2023?"
3. "What are Buffett's views on diversification?"
4. "How has Berkshire's strategy evolved over the past 5 years?"

## ğŸ”§ Tech Stack

- **Framework**: [Mastra](https://mastra.ai/) for AI agent orchestration
- **Frontend**: Next.js 16 with TypeScript
- **Styling**: TailwindCSS
- **AI Model**: OpenAI GPT-4o
- **Vector Store**: LibSQL with Mastra's built-in embeddings
- **Animations**: Framer Motion

## ğŸ“¦ Deployment

### Mastra Cloud (Recommended)
```bash
mastra deploy
```

### Docker
```bash
docker build -t berkshire-intelligence .
docker run -p 3000:3000 -p 4111:4111 berkshire-intelligence
```

## ğŸ“„ License

This project is for educational purposes as part of a RAG assignment.

## ğŸ¤ Contributing

Feel free to submit issues and pull requests!
